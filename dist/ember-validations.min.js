// ==========================================================================
// Project:   Ember Validations
// Copyright: Â© 2013 DockYar, LLC. and contributors.
// License:   Licensed under MIT license (see license.js)
// ==========================================================================


// Last commit: 365d185 (2013-08-14 05:34:39 -0700)


!function(){Ember.Validations=Ember.Namespace.create({VERSION:"0.2.1"})}(),function(){Ember.Application.reopen({bootstrapValidations:function(t){function i(t){var s,e,o={};for(s in t)e="object"==typeof t[s]?i(t[s]):t[s],o[s.camelize()]=e;return o}var s,e,o={};for(s in t)e=(new(this[s.camelize().capitalize()])).get("validations"),o=i(t[s]),this[s.camelize().capitalize()].reopen({validations:Ember.$.extend(!0,{},o,e)})}})}(),function(){Ember.Validations.messages={render:function(t,i){return Handlebars.compile(Ember.Validations.messages.defaults[t])(i)},defaults:{inclusion:"is not included in the list",exclusion:"is reserved",invalid:"is invalid",confirmation:"doesn't match {{attribute}}",accepted:"must be accepted",empty:"can't be empty",blank:"can't be blank",present:"must be blank",tooLong:"is too long (maximum is {{count}} characters)",tooShort:"is too short (minimum is {{count}} characters)",wrongLength:"is the wrong length (should be {{count}} characters)",notANumber:"is not a number",notAnInteger:"must be an integer",greaterThan:"must be greater than {{count}}",greaterThanOrEqualTo:"must be greater than or equal to {{count}}",equalTo:"must be equal to {{count}}",lessThan:"must be less than {{count}}",lessThanOrEqualTo:"must be less than or equal to {{count}}",otherThan:"must be other than {{count}}",odd:"must be odd",even:"must be even"}}}(),function(){Ember.Validations.Errors=Ember.Object.extend({unknownProperty:function(t){return this.set(t,Ember.makeArray()),this.get(t)}})}(),function(){var t=function(){this.get("validators").filterProperty("isValid",!1).get("length")>0?this.get("isValid")===!1?this.notifyPropertyChange("isValid"):this.set("isValid",!1):this.get("isValid")===!0?this.notifyPropertyChange("isValid"):this.set("isValid",!0)},i=Ember.Object.extend({init:function(){this._super(),this.addObserver("validators.@each.isValid",this,t),this.model.addObserver(""+this.property+".[]",this,t)},validate:function(){var t;return t=this.get("validators").map(function(t){return t.validate()}).without(void 0),Ember.RSVP.all(t)}});Ember.Validations.Mixin=Ember.Mixin.create({init:function(){this._super(),this.set("errors",Ember.Validations.Errors.create()),void 0===this.get("validations")&&this.set("validations",{}),this.buildValidators(),this.addObserver("validators.@each.isValid",this,t),this.validators.forEach(function(t){t.addObserver("errors.[]",this,function(t){var i=Ember.makeArray();this.validators.forEach(function(s){s.property===t.property&&(i=i.concat(s.errors))},this),this.set("errors."+t.property,i)})},this),this.validate()},isInvalid:function(){return!this.get("isValid")}.property("isValid"),buildValidators:function(){this.set("validators",Ember.A([])),this.validations.constructor===Array?this.buildCompositeValidators(this.validations):this.buildPropertyValidators(this.validations)},buildCompositeValidators:function(t){var s,e;for(s=0;s<t.length;s++)e=t[s],e.constructor===Object?this.buildPropertyValidators(e):e.constructor===String?this.get(e).constructor===Array?this.validators.pushObject(i.create({model:this,property:e,validators:this.get(e)})):this.validators.pushObject(this.get(e)):void 0===e.validate?this.validators.pushObject(e.create({model:this})):this.validators.pushObject(e)},buildPropertyValidators:function(t){var i,s,e;i=function(t){var i=t.classify();return Ember.Validations.validators.local[i]||Ember.Validations.validators.remote[i]};for(s in t)if(t.hasOwnProperty(s))for(e in t[s])t[s].hasOwnProperty(e)&&this.validators.pushObject(i(e).create({model:this,property:s,options:t[s][e]}))},validate:function(){var t;return this.set("isValid",!0),t=this.validators.map(function(t){return t.validate()}).without(void 0),Ember.RSVP.all(t)}})}(),function(){Ember.Validations.patterns=Ember.Namespace.create({numericality:/^(-|\+)?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d*)?$/,blank:/^\s*$/})}(),function(){Ember.Validations.validators=Ember.Namespace.create(),Ember.Validations.validators.local=Ember.Namespace.create(),Ember.Validations.validators.remote=Ember.Namespace.create()}(),function(){Ember.Validations.validators.Base=Ember.Object.extend({init:function(){this.set("errors",Ember.makeArray()),this.conditionals={"if":this.get("options.if"),unless:this.get("options.unless")},this.model.addObserver(this.property,this,this.validate)},call:function(){throw"Not implemented!"},unknownProperty:function(t){var i=this.get("model");return i?i.get(t):void 0},validate:function(){return this.canValidate()?(this.errors.clear(),this.call(),this.errors.length>0?(this.get("isValid")===!1?this.notifyPropertyChange("isValid"):this.set("isValid",!1),Ember.RSVP.reject()):(this.get("isValid")===!0?this.notifyPropertyChange("isValid"):this.set("isValid",!0),Ember.RSVP.resolve())):void 0},canValidate:function(){if("object"!=typeof this.conditionals)return!0;if(this.conditionals["if"]){if("function"==typeof this.conditionals["if"])return this.conditionals["if"](this.model);if("string"==typeof this.conditionals["if"])return"function"==typeof this.model[this.conditionals["if"]]?this.model[this.conditionals["if"]]():this.model.get(this.conditionals["if"])}else{if(!this.conditionals.unless)return!0;if("function"==typeof this.conditionals.unless)return!this.conditionals.unless(this.model);if("string"==typeof this.conditionals.unless)return"function"==typeof this.model[this.conditionals.unless]?!this.model[this.conditionals.unless]():!this.model.get(this.conditionals.unless)}}})}(),function(){Ember.Validations.validators.local.Absence=Ember.Validations.validators.Base.extend({init:function(){this._super(),this.options===!0&&this.set("options",{}),void 0===this.options.message&&this.set("options.message",Ember.Validations.messages.render("present",this.options))},call:function(){Ember.Validations.Utilities.isBlank(this.model.get(this.property))||this.errors.pushObject(this.options.message)}})}(),function(){Ember.Validations.validators.local.Acceptance=Ember.Validations.validators.Base.extend({init:function(){this._super(),this.options===!0&&this.set("options",{}),void 0===this.options.message&&this.set("options.message",Ember.Validations.messages.render("accepted",this.options))},call:function(){this.options.accept?this.model.get(this.property)!==this.options.accept&&this.errors.pushObject(this.options.message):"1"!==this.model.get(this.property)&&1!==this.model.get(this.property)&&this.model.get(this.property)!==!0&&this.errors.pushObject(this.options.message)}})}(),function(){Ember.Validations.validators.local.Confirmation=Ember.Validations.validators.Base.extend({init:function(){this.originalProperty=this.property,this.property=this.property+"Confirmation",this._super(),this.model.addObserver(this.originalProperty,this,this.validate),this.options===!0&&(this.set("options",{attribute:this.originalProperty}),this.set("options",{message:Ember.Validations.messages.render("confirmation",this.options)}))},call:function(){this.model.get(this.originalProperty)!==this.model.get(this.property)&&this.errors.pushObject(this.options.message)}})}(),function(){Ember.Validations.validators.local.Exclusion=Ember.Validations.validators.Base.extend({init:function(){this._super(),this.options.constructor===Array&&this.set("options",{"in":this.options}),void 0===this.options.message&&this.set("options.message",Ember.Validations.messages.render("exclusion",this.options))},call:function(){var t,i;Ember.Validations.Utilities.isBlank(this.model.get(this.property))?void 0===this.options.allowBlank&&this.errors.pushObject(this.options.message):this.options["in"]?-1!==Ember.$.inArray(this.model.get(this.property),this.options["in"])&&this.errors.pushObject(this.options.message):this.options.range&&(t=this.options.range[0],i=this.options.range[1],this.model.get(this.property)>=t&&this.model.get(this.property)<=i&&this.errors.pushObject(this.options.message))}})}(),function(){Ember.Validations.validators.local.Format=Ember.Validations.validators.Base.extend({init:function(){this._super(),this.options.constructor===RegExp&&this.set("options",{"with":this.options}),void 0===this.options.message&&this.set("options.message",Ember.Validations.messages.render("invalid",this.options))},call:function(){Ember.Validations.Utilities.isBlank(this.model.get(this.property))?void 0===this.options.allowBlank&&this.errors.pushObject(this.options.message):this.options["with"]&&!this.options["with"].test(this.model.get(this.property))?this.errors.pushObject(this.options.message):this.options.without&&this.options.without.test(this.model.get(this.property))&&this.errors.pushObject(this.options.message)}})}(),function(){Ember.Validations.validators.local.Inclusion=Ember.Validations.validators.Base.extend({init:function(){this._super(),this.options.constructor===Array&&this.set("options",{"in":this.options}),void 0===this.options.message&&this.set("options.message",Ember.Validations.messages.render("inclusion",this.options))},call:function(){var t,i;Ember.Validations.Utilities.isBlank(this.model.get(this.property))?void 0===this.options.allowBlank&&this.errors.pushObject(this.options.message):this.options["in"]?-1===Ember.$.inArray(this.model.get(this.property),this.options["in"])&&this.errors.pushObject(this.options.message):this.options.range&&(t=this.options.range[0],i=this.options.range[1],(this.model.get(this.property)<t||this.model.get(this.property)>i)&&this.errors.pushObject(this.options.message))}})}(),function(){Ember.Validations.validators.local.Length=Ember.Validations.validators.Base.extend({init:function(){var t,i;for(this._super(),"number"==typeof this.options&&this.set("options",{is:this.options}),void 0===this.options.messages&&this.set("options.messages",{}),t=0;t<this.messageKeys().length;t++)i=this.messageKeys()[t],void 0!==this.options[i]&&void 0===this.options.messages[this.MESSAGES[i]]&&(-1!==Ember.$.inArray(i,this.checkKeys())&&(this.options.count=this.options[i]),this.options.messages[this.MESSAGES[i]]=Ember.Validations.messages.render(this.MESSAGES[i],this.options),void 0!==this.options.count&&delete this.options.count);this.allowBlankOptions={},this.options.is?this.allowBlankOptions.message=this.options.messages.wrongLength:this.options.minimum&&(this.allowBlankOptions.message=this.options.messages.tooShort),this.tokenizedLength=new Function("value",'return (value || "").'+(this.options.tokenizer||'split("")')+".length")},CHECKS:{is:"==",minimum:">=",maximum:"<="},MESSAGES:{is:"wrongLength",minimum:"tooShort",maximum:"tooLong"},messageKeys:function(){return Object.keys(this.MESSAGES)},checkKeys:function(){return Object.keys(this.CHECKS)},call:function(){var t,i,s;if(Ember.Validations.Utilities.isBlank(this.model.get(this.property)))void 0===this.options.allowBlank&&(this.options.is||this.options.minimum)&&this.errors.pushObject(this.allowBlankOptions.message);else for(t in this.CHECKS)s=this.CHECKS[t],this.options[t]&&(i=new Function("return "+this.tokenizedLength(this.model.get(this.property))+" "+s+" "+this.options[t]),i()||this.errors.pushObject(this.options.messages[this.MESSAGES[t]]))}})}(),function(){Ember.Validations.validators.local.Numericality=Ember.Validations.validators.Base.extend({init:function(){var t,i,s;for(this._super(),this.options===!0&&(this.options={}),void 0===this.options.messages&&(this.options.messages={numericality:Ember.Validations.messages.render("notANumber",this.options)}),void 0!==this.options.onlyInteger&&void 0===this.options.messages.onlyInteger&&(this.options.messages.onlyInteger=Ember.Validations.messages.render("notAnInteger",this.options)),i=Object.keys(this.CHECKS).concat(["odd","even"]),t=0;t<i.length;t++)s=i[t],isNaN(this.options[s])&&this.model.addObserver(this.options[s],this,this.validate),void 0!==this.options[s]&&void 0===this.options.messages[s]&&(-1!==Ember.$.inArray(s,Object.keys(this.CHECKS))&&(this.options.count=this.options[s]),this.options.messages[s]=Ember.Validations.messages.render(s,this.options),void 0!==this.options.count&&delete this.options.count)},CHECKS:{equalTo:"===",greaterThan:">",greaterThanOrEqualTo:">=",lessThan:"<",lessThanOrEqualTo:"<="},call:function(){var t,i,s,e;if(Ember.Validations.Utilities.isBlank(this.model.get(this.property)))void 0===this.options.allowBlank&&this.errors.pushObject(this.options.messages.numericality);else if(Ember.Validations.patterns.numericality.test(this.model.get(this.property)))if(this.options.onlyInteger!==!0||/^[+\-]?\d+$/.test(this.model.get(this.property)))if(this.options.odd&&0===parseInt(this.model.get(this.property),10)%2)this.errors.pushObject(this.options.messages.odd);else if(this.options.even&&0!==parseInt(this.model.get(this.property),10)%2)this.errors.pushObject(this.options.messages.even);else for(t in this.CHECKS)e=this.CHECKS[t],void 0!==this.options[t]&&(!isNaN(parseFloat(this.options[t]))&&isFinite(this.options[t])?i=this.options[t]:void 0!==this.model.get(this.options[t])&&(i=this.model.get(this.options[t])),s=new Function("return "+this.model.get(this.property)+" "+e+" "+i),s()||this.errors.pushObject(this.options.messages[t]));else this.errors.pushObject(this.options.messages.onlyInteger);else this.errors.pushObject(this.options.messages.numericality)}})}(),function(){Ember.Validations.validators.local.Presence=Ember.Validations.validators.Base.extend({init:function(){this._super(),this.options===!0&&(this.options={}),void 0===this.options.message&&(this.options.message=Ember.Validations.messages.render("blank",this.options))},call:function(){Ember.Validations.Utilities.isBlank(this.model.get(this.property))&&this.errors.pushObject(this.options.message)}})}(),function(){Ember.Validations.Utilities={isBlank:function(t){return 0!==t&&(!t||/^\s*$/.test(""+t))}}}(),"undefined"==typeof location||"localhost"!==location.hostname&&"127.0.0.1"!==location.hostname||Ember.Logger.warn("You are running a production build of Ember on localhost and won't receive detailed error messages. If you want full error messages please use the non-minified build provided on the Ember website.");